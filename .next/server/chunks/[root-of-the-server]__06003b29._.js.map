{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///Users/sebkeating/Documents/ScaleWize/Web%20Dev/scalewize-website/src/app/api/debug-invite/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs'\nimport { cookies } from 'next/headers'\nimport { Database } from '@/types/database'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { email, organizationId } = await request.json()\n    \n    // Fix for Next.js 15: await cookies() before using\n    const cookieStore = await cookies()\n    const supabase = createRouteHandlerClient<Database>({ cookies: () => cookieStore })\n\n    // Get current user\n    const { data: { user }, error: authError } = await supabase.auth.getUser()\n    \n    // Get session\n    const { data: { session }, error: sessionError } = await supabase.auth.getSession()\n\n    // Check if user is admin of the organization\n    let profile = null\n    let profileError = null\n    \n    if (user) {\n      const { data: profileData, error: profileErr } = await supabase\n        .from('profiles')\n        .select('*')\n        .eq('id', user.id)\n        .eq('organization_id', organizationId)\n        .in('role', ['admin', 'super_admin'])\n        .single()\n      \n      profile = profileData\n      profileError = profileErr\n    }\n\n    return NextResponse.json({\n      success: true,\n      debug: {\n        user: user ? {\n          id: user.id,\n          email: user.email,\n          email_confirmed_at: user.email_confirmed_at\n        } : null,\n        session: session ? {\n          access_token: session.access_token ? 'present' : 'missing',\n          refresh_token: session.refresh_token ? 'present' : 'missing',\n          expires_at: session.expires_at\n        } : null,\n        profile: profile ? {\n          id: profile.id,\n          role: profile.role,\n          organization_id: profile.organization_id\n        } : null,\n        errors: {\n          authError: authError?.message,\n          sessionError: sessionError?.message,\n          profileError: profileError?.message\n        },\n        cookies: {\n          hasAuthCookie: !!cookieStore.get('sb-mtybaactacapokejmtxy-auth-token'),\n          authCookieValue: cookieStore.get('sb-mtybaactacapokejmtxy-auth-token')?.value?.substring(0, 50) + '...'\n        }\n      }\n    })\n\n  } catch (error) {\n    console.error('Debug invite error:', error)\n    return NextResponse.json({\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error'\n    })\n  }\n}\n"],"names":[],"mappings":";;;AAAA;AACA;AACA;;;;AAGO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,cAAc,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEpD,mDAAmD;QACnD,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;QAChC,MAAM,WAAW,CAAA,GAAA,0KAAA,CAAA,2BAAwB,AAAD,EAAY;YAAE,SAAS,IAAM;QAAY;QAEjF,mBAAmB;QACnB,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAExE,cAAc;QACd,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;QAEjF,6CAA6C;QAC7C,IAAI,UAAU;QACd,IAAI,eAAe;QAEnB,IAAI,MAAM;YACR,MAAM,EAAE,MAAM,WAAW,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,SACpD,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,EAAE,CAAC,mBAAmB,gBACtB,EAAE,CAAC,QAAQ;gBAAC;gBAAS;aAAc,EACnC,MAAM;YAET,UAAU;YACV,eAAe;QACjB;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO;gBACL,MAAM,OAAO;oBACX,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,oBAAoB,KAAK,kBAAkB;gBAC7C,IAAI;gBACJ,SAAS,UAAU;oBACjB,cAAc,QAAQ,YAAY,GAAG,YAAY;oBACjD,eAAe,QAAQ,aAAa,GAAG,YAAY;oBACnD,YAAY,QAAQ,UAAU;gBAChC,IAAI;gBACJ,SAAS,UAAU;oBACjB,IAAI,QAAQ,EAAE;oBACd,MAAM,QAAQ,IAAI;oBAClB,iBAAiB,QAAQ,eAAe;gBAC1C,IAAI;gBACJ,QAAQ;oBACN,WAAW,WAAW;oBACtB,cAAc,cAAc;oBAC5B,cAAc,cAAc;gBAC9B;gBACA,SAAS;oBACP,eAAe,CAAC,CAAC,YAAY,GAAG,CAAC;oBACjC,iBAAiB,YAAY,GAAG,CAAC,uCAAuC,OAAO,UAAU,GAAG,MAAM;gBACpG;YACF;QACF;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD;IACF;AACF","debugId":null}}]
}