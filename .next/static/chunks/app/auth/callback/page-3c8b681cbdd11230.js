(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[769],{447:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(5155),a=t(2115),i=t(5695),l=t(2409),n=t(1154),c=t(646),o=t(5339);function d(){let[e,s]=(0,a.useState)("loading"),[t,d]=(0,a.useState)(""),u=(0,i.useRouter)(),x=(0,i.useSearchParams)();return((0,a.useEffect)(()=>{(async()=>{try{let t=x.get("code");if(t){let{error:e}=await l.N.auth.exchangeCodeForSession(t);if(e){s("error"),d("Authentication error: "+e.message);return}}let{data:r,error:a}=await l.N.auth.getSession();if(a){s("error"),d("Authentication error: "+a.message);return}if(r.session){let t=x.get("org")||void 0,a=x.get("role")||void 0;if(t){var e;let{data:i,error:n}=await l.N.from("profiles").upsert({id:r.session.user.id,email:r.session.user.email||"",full_name:(null==(e=r.session.user.user_metadata)?void 0:e.full_name)||null,organization_id:t,role:a||"user",is_active:!0},{onConflict:"id"}).select().single();if(n){s("error"),d("Failed to complete invitation: "+n.message);return}}let{data:i,error:n}=await l.N.from("profiles").select("*").eq("id",r.session.user.id).single();if(n&&"PGRST116"===n.code){s("error"),d("Profile not found. Please contact your organization administrator.");return}i&&(s("success"),d("Authentication successful! Redirecting to dashboard..."),setTimeout(()=>{u.push("/dashboard")},2e3))}else s("error"),d("No active session found.")}catch(e){s("error"),d("An unexpected error occurred: "+(e instanceof Error?e.message:"Unknown error"))}})()},[u,x]),"loading"===e)?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8 text-center",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(n.A,{className:"h-16 w-16 animate-spin",style:{color:"#595F39"}})}),(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Processing Authentication"}),(0,r.jsx)("p",{className:"text-lg text-gray-600",children:"Please wait while we verify your credentials..."})]})}):"success"===e?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8 text-center",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(c.A,{className:"h-16 w-16 text-green-600"})}),(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Welcome Back!"}),(0,r.jsx)("p",{className:"text-lg text-gray-600",children:t}),(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-sm text-green-800",children:"You will be redirected to your dashboard shortly."})})]})}):"error"===e?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8 text-center",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(o.A,{className:"h-16 w-16 text-red-600"})}),(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Authentication Failed"}),(0,r.jsx)("p",{className:"text-lg text-gray-600",children:t}),(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-sm text-red-800",children:"Please try again or contact support if the problem persists."})}),(0,r.jsx)("div",{className:"pt-4",children:(0,r.jsx)("button",{onClick:()=>u.push("/login"),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white",style:{backgroundColor:"#595F39"},children:"Back to Login"})})]})}):null}function u(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 mb-4",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-t-2",style:{borderColor:"#595F39"}})}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading..."}),(0,r.jsx)("p",{className:"text-gray-600",children:"Preparing authentication..."})]})}),children:(0,r.jsx)(d,{})})}},646:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1154:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2409:(e,s,t)=>{"use strict";t.d(s,{N:()=>r});let r=(0,t(3254).createBrowserClient)("https://mtybaactacapokejmtxy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im10eWJhYWN0YWNhcG9rZWptdHh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTE5MTMsImV4cCI6MjA2NzI4NzkxM30.u9EudibnPY-rGAFX4E2TfCgyKEBa9_7a2nojUcICJGQ")},5339:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},5695:(e,s,t)=>{"use strict";var r=t(8999);t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},8285:(e,s,t)=>{Promise.resolve().then(t.bind(t,447))}},e=>{var s=s=>e(e.s=s);e.O(0,[691,441,684,358],()=>s(8285)),_N_E=e.O()}]);