(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{283:(e,s,a)=>{"use strict";a.d(s,{A:()=>o,O:()=>d});var t=a(5155),l=a(2115),r=a(5695),i=a(2409);let n=(0,l.createContext)(void 0);function d(e){let{children:s}=e,[a,d]=(0,l.useState)(null),[o,c]=(0,l.useState)(null),[m,x]=(0,l.useState)(null),[h,g]=(0,l.useState)(!0),u=(0,r.useRouter)();(0,l.useEffect)(()=>{let e=!1;!async function(){g(!0);try{var s,a;console.log("Loading session...");let{data:{session:t},error:l}=await i.N.auth.getSession();if(l&&console.error("Session error:",l),e)return;console.log("Session loaded:",(null==t||null==(s=t.user)?void 0:s.id)||"No user"),d(null!=(a=null==t?void 0:t.user)?a:null),(null==t?void 0:t.user)&&await N(t.user.id)}catch(e){console.error("Error loading session:",e)}finally{e||g(!1)}}();let{data:{subscription:s}}=i.N.auth.onAuthStateChange(async(s,a)=>{var t,l;e||(console.log("Auth state changed:",s,(null==a||null==(t=a.user)?void 0:t.id)||"No user"),d(null!=(l=null==a?void 0:a.user)?l:null),(null==a?void 0:a.user)?await N(a.user.id):(console.log("No session, clearing profile and organization"),c(null),x(null),"/login"!==window.location.pathname&&u.push("/login")),g(!1))});return()=>{e=!0,s.unsubscribe()}},[u]);let N=async e=>{try{console.log("Fetching profile for user:",e);let{data:s,error:a}=await i.N.from("profiles").select("*").eq("id",e).single();if(a){console.error("Profile fetch error:",a),console.error("Error details:",{message:a.message,details:a.details,hint:a.hint,code:a.code}),c(null),x(null);return}if(console.log("Profile fetched successfully:",s),c(s),null==s?void 0:s.organization_id){console.log("Fetching organization:",s.organization_id);let{data:e,error:a}=await i.N.from("organizations").select("*").eq("id",s.organization_id).single();a?(console.error("Organization fetch error:",a),console.error("Organization error details:",{message:a.message,details:a.details,hint:a.hint,code:a.code}),x(null)):(console.log("Organization fetched successfully:",e),x(e))}else console.log("No organization_id in profile"),x(null)}catch(e){console.error("Unexpected error in fetchProfile:",e),console.error("Error stack:",e.stack),c(null),x(null)}},p=async()=>{try{console.log("Signing out..."),await i.N.auth.signOut(),localStorage.clear(),sessionStorage.clear(),window.location.href="/login"}catch(e){console.error("Error during sign out:",e),window.location.href="/login"}};return(0,t.jsx)(n.Provider,{value:{user:a,profile:o,organization:m,loading:h,signOut:p},children:h?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-t-2",style:{borderColor:"#595F39"}}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mt-4",children:"Loading ScaleWize AI"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Connecting to your workspace..."})]})}):s})}function o(){let e=(0,l.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},381:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},673:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>y});var t=a(5155),l=a(2115),r=a(283),i=a(2409),n=a(381),d=a(2138),o=a(7580),c=a(9946);let m=(0,c.A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var x=a(3109),h=a(1497),g=a(1539);let u=(0,c.A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var N=a(5339),p=a(6874),v=a.n(p);function y(){var e;let{profile:s,organization:a}=(0,r.A)(),[c,p]=(0,l.useState)({totalMembers:0,activeMembers:0,pendingInvitations:0,chatSessions:0,tokenUsage:0,tokenLimit:1e5}),[y,j]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(null==a?void 0:a.id)&&b()},[null==a?void 0:a.id]);let b=async()=>{try{j(!0);let{count:e}=await i.N.from("profiles").select("*",{count:"exact",head:!0}).eq("organization_id",null==a?void 0:a.id),{count:s}=await i.N.from("profiles").select("*",{count:"exact",head:!0}).eq("organization_id",null==a?void 0:a.id).eq("status","active"),{count:t}=await i.N.from("invitations").select("*",{count:"exact",head:!0}).eq("organization_id",null==a?void 0:a.id).eq("status","pending");p({totalMembers:e||0,activeMembers:s||0,pendingInvitations:t||0,chatSessions:0,tokenUsage:0,tokenLimit:(null==a?void 0:a.monthly_token_limit)||1e5})}catch(e){console.error("Error loading dashboard stats:",e)}finally{j(!1)}},f=(e,s)=>0===s?0:Math.min(e/s*100,100);return y?(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:"h-32 bg-gray-200 rounded"},e))})]})}):(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-8",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl shadow-lg p-8 text-white",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold mb-2",children:["Welcome back, ",(null==s?void 0:s.full_name)||"Admin","! \uD83D\uDC4B"]}),(0,t.jsx)("p",{className:"text-blue-100 text-lg",children:"Manage your organization and monitor performance"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:null==a?void 0:a.name}),(0,t.jsxs)("div",{className:"text-blue-100 capitalize",children:[null==a?void 0:a.plan_type," Plan"]})]})]})}),(null==s?void 0:s.role)==="admin"&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsx)(v(),{href:"/dashboard/settings",className:"bg-white rounded-lg shadow p-6 hover:shadow-md transition-shadow border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,t.jsx)(n.A,{className:"h-6 w-6 text-blue-600"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Organization Settings"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Manage members and limits"})]})]}),(0,t.jsx)(d.A,{className:"h-5 w-5 text-gray-400"})]})}),(0,t.jsx)(v(),{href:"/dashboard/settings",className:"bg-white rounded-lg shadow p-6 hover:shadow-md transition-shadow border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,t.jsx)(o.A,{className:"h-6 w-6 text-green-600"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Invite Members"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Grow your team"})]})]}),(0,t.jsx)(m,{className:"h-5 w-5 text-gray-400"})]})}),(0,t.jsx)(v(),{href:"/dashboard/analytics",className:"bg-white rounded-lg shadow p-6 hover:shadow-md transition-shadow border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-3 bg-purple-100 rounded-lg",children:(0,t.jsx)(x.A,{className:"h-6 w-6 text-purple-600"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"View Analytics"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Track performance"})]})]}),(0,t.jsx)(d.A,{className:"h-5 w-5 text-gray-400"})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,t.jsx)(o.A,{className:"h-6 w-6 text-blue-600"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Members"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:c.totalMembers}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["of ",(null==a?void 0:a.max_users)||50," allowed"]})]})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,t.jsx)(h.A,{className:"h-6 w-6 text-green-600"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Chat Sessions"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:c.chatSessions}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["of ",(null==a?void 0:a.max_chat_sessions)||1e3," allowed"]})]})]})}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,t.jsx)(g.A,{className:"h-6 w-6 text-purple-600"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Token Usage"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:c.tokenUsage.toLocaleString()}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["of ",c.tokenLimit.toLocaleString()," allowed"]})]})]}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"h-2 rounded-full ".concat(((e=f(c.tokenUsage,c.tokenLimit))<70?"text-green-600 bg-green-100":e<90?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100").split(" ")[1]),style:{width:"".concat(f(c.tokenUsage,c.tokenLimit),"%")}})})})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,t.jsx)(u,{className:"h-6 w-6 text-orange-600"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending Invites"}),(0,t.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:c.pendingInvitations}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"awaiting response"})]})]})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[c.totalMembers>=.9*((null==a?void 0:a.max_users)||50)&&(0,t.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(N.A,{className:"h-5 w-5 text-yellow-600 mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-yellow-800",children:"Approaching User Limit"}),(0,t.jsxs)("p",{className:"text-sm text-yellow-700 mt-1",children:["You're at ",Math.round(c.totalMembers/((null==a?void 0:a.max_users)||50)*100),"% of your user limit. Consider upgrading your plan or removing inactive members."]})]})]})}),c.pendingInvitations>0&&(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(u,{className:"h-5 w-5 text-blue-600 mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-blue-800",children:"Pending Invitations"}),(0,t.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["You have ",c.pendingInvitations," pending invitation",c.pendingInvitations>1?"s":"",".",(0,t.jsx)(v(),{href:"/dashboard/settings",className:"text-blue-800 font-medium hover:underline ml-1",children:"Manage invitations â†’"})]})]})]})}),f(c.tokenUsage,c.tokenLimit)>80&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(N.A,{className:"h-5 w-5 text-red-600 mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"High Token Usage"}),(0,t.jsxs)("p",{className:"text-sm text-red-700 mt-1",children:["You're at ",Math.round(f(c.tokenUsage,c.tokenLimit)),"% of your monthly token limit. Consider upgrading your plan or monitoring usage."]})]})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,t.jsx)(h.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Recent Activity"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Activity will appear here as your team uses the platform"})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Access"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)(v(),{href:"/dashboard/chatbot",className:"flex items-center p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(h.A,{className:"h-5 w-5 text-blue-600 mr-3"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"AI Chatbot"})]}),(0,t.jsxs)(v(),{href:"/dashboard/linkedin",className:"flex items-center p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(o.A,{className:"h-5 w-5 text-green-600 mr-3"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"LinkedIn Sales"})]}),(0,t.jsxs)(v(),{href:"/dashboard/analytics",className:"flex items-center p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(x.A,{className:"h-5 w-5 text-purple-600 mr-3"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Analytics"})]}),(0,t.jsxs)(v(),{href:"/dashboard/settings",className:"flex items-center p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(n.A,{className:"h-5 w-5 text-gray-600 mr-3"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Settings"})]})]})]})]})}},1497:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},1539:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},2138:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},2409:(e,s,a)=>{"use strict";a.d(s,{N:()=>t});let t=(0,a(3254).createBrowserClient)("https://mtybaactacapokejmtxy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im10eWJhYWN0YWNhcG9rZWptdHh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3MTE5MTMsImV4cCI6MjA2NzI4NzkxM30.u9EudibnPY-rGAFX4E2TfCgyKEBa9_7a2nojUcICJGQ")},2716:(e,s,a)=>{Promise.resolve().then(a.bind(a,673))},3109:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},5339:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7580:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[925,874,441,684,358],()=>s(2716)),_N_E=e.O()}]);